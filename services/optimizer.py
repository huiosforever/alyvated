<optimizer.py content from earlier>